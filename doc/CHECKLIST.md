# AI旅行规划师 - 开发检查清单

本文档用于追踪项目开发进度，每完成一个任务就勾选对应的复选框。

---

## 📋 阶段0: 项目初始化

### 环境搭建
- [ ] 安装Node.js >= 20.0.0
- [ ] 安装Docker和Docker Compose
- [ ] 安装VS Code及推荐扩展
- [ ] 配置Git用户信息

### 项目创建
- [ ] 创建GitHub仓库
- [ ] 配置.gitignore和.dockerignore
- [ ] 创建项目目录结构（frontend, backend, docker, docs）
- [ ] 初始化前端项目（Vite + React + TypeScript）
- [ ] 初始化后端项目（Node.js + Express + TypeScript）

### 代码规范
- [ ] 配置ESLint（前后端）
- [ ] 配置Prettier（前后端）
- [ ] 配置Husky + lint-staged
- [ ] 配置EditorConfig

### 数据库
- [ ] 创建docker-compose.dev.yml
- [ ] 启动PostgreSQL容器
- [ ] 启动Redis容器
- [ ] 配置Prisma
- [ ] 创建初始数据库模式
- [ ] 运行数据库迁移

### 基础代码
- [ ] 创建后端基础结构（routes, controllers, services等）
- [ ] 创建Express应用和服务器入口
- [ ] 实现健康检查接口
- [ ] 创建前端基础结构（pages, components, modules等）
- [ ] 配置前端路由
- [ ] 配置API代理

### 验证
- [ ] 后端服务成功启动（localhost:3000）
- [ ] 前端服务成功启动（localhost:5173）
- [ ] 数据库连接成功
- [ ] Prisma Studio可以打开
- [ ] 前端可以调用后端API

### 文档
- [ ] 编写README.md
- [ ] 编写TECHNICAL_DESIGN.md
- [ ] 编写PROJECT_STRUCTURE.md
- [ ] 编写QUICK_START.md

---

## 📋 阶段1: 用户认证系统 (3-4天)

### 第三方服务
- [ ] 注册阿里云账号（如需）
- [ ] 获取第三方API密钥（用于后续阶段）

### 数据模型
- [ ] 设计User模型（SQLAlchemy Model）
- [ ] 设计UserPreference模型
- [ ] 创建Alembic迁移脚本
- [ ] 执行数据库迁移

### 后端实现（Python + FastAPI）
- [ ] 安装Python依赖（Poetry）
- [ ] 配置FastAPI应用（main.py）
- [ ] 配置数据库连接（SQLAlchemy）
- [ ] 实现密码加密工具（passlib + bcrypt）
- [ ] 实现JWT生成和验证工具（python-jose）
- [ ] 创建Pydantic Schema（请求/响应）
- [ ] 实现用户注册端点（POST /api/v1/auth/register）
- [ ] 实现用户登录端点（POST /api/v1/auth/login）
- [ ] 实现Token刷新端点（POST /api/v1/auth/refresh）
- [ ] 实现JWT认证依赖（get_current_user）
- [ ] 实现用户信息查询端点（GET /api/v1/auth/me）
- [ ] 实现认证服务层（AuthService）

### 前端实现
- [ ] 创建认证状态管理（Zustand Store）
- [ ] 创建认证服务（API调用）
- [ ] 创建登录页面UI
- [ ] 创建注册页面UI
- [ ] 实现表单验证（React Hook Form + Zod）
- [ ] 实现路由守卫
- [ ] 实现Token自动刷新
- [ ] 实现退出登录功能
- [ ] 创建个人信息页面

### 测试
- [ ] 编写用户注册单元测试（pytest）
- [ ] 编写用户登录单元测试（pytest）
- [ ] 编写JWT依赖单元测试（pytest）
- [ ] 编写API集成测试（pytest + httpx）
- [ ] 编写前端组件测试（Vitest）

### 验证
- [ ] 用户可以成功注册
- [ ] 用户可以成功登录
- [ ] Token正确生成和验证
- [ ] 受保护路由需要登录
- [ ] Token过期自动刷新
- [ ] 所有测试通过

---

## 📋 阶段2: LLM-Agent模块开发 (5-6天)

### 第三方服务
- [ ] 申请阿里云百炼平台API Key
- [ ] 测试API Key可用性
- [ ] 阅读AG-UI协议文档（doc/AG-UI.txt）

### AG-UI协议实现（核心）
- [ ] 安装AG-UI依赖（rxjs, fast-json-patch）
- [ ] 定义AG-UI事件类型（16种标准事件）
- [ ] 实现AbstractAgent基类
- [ ] 实现事件流Observable生成器
- [ ] 实现SSE事件编码器（EventEncoder）
- [ ] 实现消息格式转换（AG-UI ↔ 阿里云API）
- [ ] 实现状态管理（StateSnapshot/StateDelta）
- [ ] 测试事件流完整性和顺序

### LLM服务集成
- [ ] 封装阿里云LLM API调用
- [ ] 实现流式响应转换（阿里云 → AG-UI事件）
- [ ] 实现错误处理（RUN_ERROR事件）
- [ ] 实现对话历史管理（Messages数组）
- [ ] 实现消息格式转换器

### 前端工具定义（Frontend Tools）
- [ ] 定义POI搜索工具（Tool Schema）
- [ ] 定义路线计算工具（Tool Schema）
- [ ] 定义价格查询工具（Tool Schema）
- [ ] 实现工具执行处理器
- [ ] 实现工具结果返回（ToolMessage）

### 提示词工程
- [ ] 设计系统提示词（包含工具使用说明）
- [ ] 设计行程规划提示词模板
- [ ] 设计费用预算提示词模板
- [ ] 设计行程优化提示词模板
- [ ] 测试提示词与工具配合效果

### Agent实现
- [ ] 实现TripPlannerAgent（继承AbstractAgent）
- [ ] 实现BudgetAnalyzerAgent
- [ ] 实现ChatAssistantAgent
- [ ] 实现run()方法发出AG-UI事件流
- [ ] 实现工具调用流程（TOOL_CALL_*事件）

### HTTP端点实现
- [ ] 实现POST /api/v1/agent/trip-planner（SSE流）
- [ ] 实现POST /api/v1/agent/budget-analyzer
- [ ] 实现POST /api/v1/agent/chat-assistant
- [ ] 配置SSE响应头
- [ ] 实现客户端断开连接处理

### 前端AG-UI客户端
- [ ] 安装前端AG-UI依赖（rxjs, @microsoft/fetch-event-source）
- [ ] 实现AG-UI事件订阅器（AgentSubscriber）
- [ ] 实现EventSource SSE客户端（支持POST）
- [ ] 实现事件处理器（onTextMessageContent等）
- [ ] 实现流式UI更新
- [ ] 实现工具调用UI交互
- [ ] 实现状态同步显示

### 测试
- [ ] 测试AG-UI事件格式
- [ ] 测试事件顺序正确性
- [ ] 测试SSE连接建立
- [ ] 测试LLM API调用和转换
- [ ] 测试行程生成功能
- [ ] 测试工具调用流程
- [ ] 测试预算估算功能
- [ ] 编写单元测试
- [ ] 编写集成测试

### 验证
- [ ] Agent正确发出所有必需的AG-UI事件
- [ ] 事件顺序符合AG-UI规范（RUN_STARTED → ... → RUN_FINISHED）
- [ ] SSE流式响应正常工作
- [ ] 可以成功调用阿里云LLM API并转换响应
- [ ] 前端工具可以被Agent调用
- [ ] 工具执行结果正确返回给Agent
- [ ] 能够生成合理的旅行行程
- [ ] 行程包含景点、餐厅、酒店、交通信息
- [ ] 能够估算详细的费用预算
- [ ] 流式响应实时显示规划过程
- [ ] 所有测试通过

---

## 📋 阶段3: 地图模块开发 (4-5天)

### 第三方服务
- [ ] 申请百度地图API Key（AK和SK）
- [ ] 测试API Key可用性

### 百度地图集成
- [ ] 前端引入百度地图JavaScript API
- [ ] 后端集成百度地图Web服务API
- [ ] 实现地图配置管理
- [ ] 测试地图加载

### 地图展示
- [ ] 实现MapContainer组件
- [ ] 实现地图初始化
- [ ] 实现地图交互（缩放、拖拽、定位）
- [ ] 实现自定义地图样式
- [ ] 实现地图控件

### POI功能
- [ ] 实现POI搜索服务（后端）
- [ ] 实现POI搜索接口
- [ ] 实现POI标记组件
- [ ] 实现POI信息窗口组件
- [ ] 实现POI分类筛选
- [ ] 实现POI详情展示

### 路线规划
- [ ] 实现路线计算服务（后端）
- [ ] 实现路线规划接口
- [ ] 实现路线覆盖层组件
- [ ] 支持多种交通方式
- [ ] 显示路线详情（距离、时间、费用）
- [ ] 实现途径点路线规划

### 行程地图
- [ ] 在地图上展示完整行程
- [ ] 实现按天展示行程路线
- [ ] 实现行程点击查看详情
- [ ] 实现行程编辑（可选）

### Hooks封装
- [ ] useMap Hook
- [ ] usePOISearch Hook
- [ ] useRouteCalc Hook
- [ ] useMapControls Hook

### 测试
- [ ] 测试地图加载
- [ ] 测试POI搜索
- [ ] 测试路线规划
- [ ] 测试地图组件
- [ ] 编写单元测试

### 验证
- [ ] 地图正常加载
- [ ] POI搜索功能正常
- [ ] 标记正确显示
- [ ] 路线规划功能正常
- [ ] 行程可视化正常
- [ ] 所有测试通过

---

## 📋 阶段4: 语音模块开发 (4-5天)

### 第三方服务
- [ ] 申请科大讯飞API（App ID、API Key、API Secret）
- [ ] 测试API可用性

### 语音识别（ASR）
- [ ] 集成科大讯飞WebAPI SDK
- [ ] 实现音频录制功能
- [ ] 实现PCM格式转换
- [ ] 实现实时流式识别
- [ ] 实现识别结果处理
- [ ] 实现语音活动检测（VAD）
- [ ] 支持中英文混合识别

### 语音合成（TTS）
- [ ] 实现文字转语音接口
- [ ] 实现语音播放功能
- [ ] 支持多种音色选择
- [ ] 实现语音队列管理
- [ ] 实现播放控制（暂停、继续、停止）

### 语音交互UI
- [ ] 实现VoiceButton组件
- [ ] 实现VoiceWave动画组件
- [ ] 实现RecordingStatus组件
- [ ] 实现VoiceFeedback组件
- [ ] 实现识别结果实时显示
- [ ] 实现错误提示

### 语音与功能集成
- [ ] 语音输入触发行程规划
- [ ] AI回复自动语音播报
- [ ] 语音添加费用记录
- [ ] 语音查询行程信息

### Hooks封装
- [ ] useVoiceInput Hook
- [ ] useVoiceOutput Hook
- [ ] useAudioRecorder Hook

### 后端接口
- [ ] 实现POST /api/v1/voice/asr
- [ ] 实现POST /api/v1/voice/tts
- [ ] 实现WebSocket /ws/voice/stream

### 测试
- [ ] 测试音频录制
- [ ] 测试语音识别
- [ ] 测试语音合成
- [ ] 测试语音组件
- [ ] 编写单元测试

### 验证
- [ ] 可以录制音频
- [ ] 语音识别准确
- [ ] 识别结果实时显示
- [ ] 语音合成正常
- [ ] 语音可触发行程规划
- [ ] 所有测试通过

---

## 📋 阶段5: 行程管理功能 (3-4天)

### 数据模型
- [ ] 设计Trip模型
- [ ] 设计Itinerary模型
- [ ] 设计ItineraryItem模型
- [ ] 设计POI模型
- [ ] 创建数据库迁移

### 后端实现
- [ ] 实现GET /api/v1/trips（行程列表）
- [ ] 实现POST /api/v1/trips（创建行程）
- [ ] 实现GET /api/v1/trips/:id（行程详情）
- [ ] 实现PUT /api/v1/trips/:id（更新行程）
- [ ] 实现DELETE /api/v1/trips/:id（删除行程）
- [ ] 实现POST /api/v1/trips/:id/share（分享行程）
- [ ] 实现行程服务层逻辑

### 前端页面
- [ ] 创建行程列表页
- [ ] 创建行程详情页
- [ ] 创建行程编辑页
- [ ] 创建行程创建向导

### 前端组件
- [ ] 实现TripCard组件
- [ ] 实现ItineraryTimeline组件
- [ ] 实现POICard组件
- [ ] 实现DayPlanner组件
- [ ] 实现行程编辑功能（拖拽排序）

### 状态管理
- [ ] 创建Trip Store
- [ ] 实现行程列表状态管理
- [ ] 实现行程详情状态管理
- [ ] 实现行程编辑状态管理

### 测试
- [ ] 测试行程CRUD接口
- [ ] 测试行程服务
- [ ] 测试行程组件
- [ ] 编写单元测试和集成测试

### 验证
- [ ] 可以查看行程列表
- [ ] 可以创建新行程
- [ ] 可以查看行程详情
- [ ] 可以编辑行程
- [ ] 可以删除行程
- [ ] 所有测试通过

---

## 📋 阶段6: 费用管理功能 (3-4天)

### 数据模型
- [ ] 设计Budget模型
- [ ] 设计Expense模型
- [ ] 设计BudgetCategory模型
- [ ] 创建数据库迁移

### 后端实现
- [ ] 实现GET /api/v1/budget/:tripId
- [ ] 实现POST /api/v1/budget/:tripId
- [ ] 实现POST /api/v1/budget/:tripId/expense
- [ ] 实现PUT /api/v1/budget/expense/:id
- [ ] 实现DELETE /api/v1/budget/expense/:id
- [ ] 实现GET /api/v1/budget/analysis
- [ ] 实现费用服务层逻辑

### 前端页面
- [ ] 创建费用管理页面
- [ ] 实现费用添加对话框
- [ ] 实现费用列表展示
- [ ] 实现预算进度展示

### 前端组件
- [ ] 实现BudgetChart组件（图表）
- [ ] 实现ExpenseList组件
- [ ] 实现ExpenseItem组件
- [ ] 实现CategoryPicker组件
- [ ] 实现BudgetProgress组件

### 费用分析
- [ ] 实现费用分类统计
- [ ] 实现预算vs实际对比
- [ ] 实现费用趋势图
- [ ] 实现超支预警
- [ ] 实现费用占比饼图

### 语音费用记录
- [ ] 实现语音输入费用信息
- [ ] 实现AI解析费用内容
- [ ] 自动创建费用记录

### 状态管理
- [ ] 创建Budget Store
- [ ] 实现费用状态管理

### 测试
- [ ] 测试费用CRUD接口
- [ ] 测试费用分析功能
- [ ] 测试费用组件
- [ ] 编写单元测试和集成测试

### 验证
- [ ] 可以设置预算
- [ ] 可以添加费用记录
- [ ] 可以使用语音添加费用
- [ ] 费用统计准确
- [ ] 预算进度正确显示
- [ ] 超支预警正常
- [ ] 所有测试通过

---

## 📋 阶段7: 前端UI/UX优化 (3-4天)

### UI设计
- [ ] 设计统一的视觉风格
- [ ] 选择配色方案
- [ ] 选择字体和排版
- [ ] 准备图标和插图
- [ ] 设计UI规范文档

### 组件优化
- [ ] 优化按钮样式
- [ ] 优化表单样式
- [ ] 优化卡片样式
- [ ] 优化导航栏
- [ ] 统一组件样式

### 动画效果
- [ ] 实现页面切换动画
- [ ] 实现组件加载动画
- [ ] 实现语音波形动画
- [ ] 实现地图标记动画
- [ ] 实现卡片悬停效果
- [ ] 实现滚动动画

### 响应式设计
- [ ] 移动端适配（375px-768px）
- [ ] 平板端适配（768px-1024px）
- [ ] 桌面端适配（>1024px）
- [ ] 测试不同设备和屏幕尺寸

### 交互优化
- [ ] 优化Loading状态
- [ ] 优化空状态展示
- [ ] 优化错误提示
- [ ] 添加操作反馈（Toast、Message）
- [ ] 添加引导提示
- [ ] 优化表单验证反馈

### 性能优化
- [ ] 实现图片懒加载
- [ ] 实现路由懒加载
- [ ] 实现组件代码分割
- [ ] 实现防抖和节流
- [ ] 实现虚拟滚动（如需）
- [ ] 优化Bundle大小

### 可访问性
- [ ] 添加键盘导航支持
- [ ] 添加ARIA标签
- [ ] 使用语义化HTML
- [ ] 检查颜色对比度

### 测试
- [ ] 使用Lighthouse测试性能
- [ ] 使用WebPageTest测试加载速度
- [ ] 测试不同浏览器兼容性
- [ ] 测试移动端体验

### 验证
- [ ] UI美观现代
- [ ] 动画流畅
- [ ] 移动端体验良好
- [ ] 首屏加载<3秒
- [ ] Lighthouse分数>90
- [ ] 所有浏览器兼容

---

## 📋 阶段8: 云端同步功能 (2-3天)

### 数据同步
- [ ] 设计同步策略
- [ ] 实现行程数据同步
- [ ] 实现费用数据同步
- [ ] 实现用户偏好同步
- [ ] 实现增量同步逻辑
- [ ] 实现冲突解决策略

### 文件上传
- [ ] 实现图片上传（本地存储）
- [ ] 实现图片压缩
- [ ] 实现语音文件存储
- [ ] 实现文件URL生成

### 后端接口
- [ ] 实现POST /api/v1/sync/push
- [ ] 实现GET /api/v1/sync/pull
- [ ] 实现GET /api/v1/sync/status
- [ ] 实现POST /api/v1/upload

### 前端实现
- [ ] 实现自动同步逻辑
- [ ] 实现手动同步功能
- [ ] 实现同步状态显示
- [ ] 实现文件上传组件
- [ ] 实现图片预览功能

### 离线支持（可选）
- [ ] 实现本地数据缓存
- [ ] 实现离线浏览
- [ ] 实现离线编辑
- [ ] 实现自动同步

### 测试
- [ ] 测试数据同步功能
- [ ] 测试文件上传功能
- [ ] 测试冲突解决
- [ ] 编写单元测试

### 验证
- [ ] 数据自动保存到云端
- [ ] 多设备数据一致
- [ ] 文件上传成功
- [ ] 图片正确显示
- [ ] 所有测试通过

---

## 📋 阶段9: 测试与Bug修复 (4-5天)

### 单元测试
- [ ] 后端Service层单元测试
- [ ] 后端Controller层单元测试
- [ ] 后端Utils单元测试
- [ ] 前端组件单元测试
- [ ] 前端Hook单元测试
- [ ] 前端Utils单元测试
- [ ] 测试覆盖率>70%

### 集成测试
- [ ] API接口集成测试
- [ ] 数据库操作测试
- [ ] 第三方服务集成测试
- [ ] WebSocket通信测试
- [ ] 文件上传测试

### E2E测试
- [ ] 用户注册登录流程
- [ ] 行程创建和编辑流程
- [ ] 费用管理流程
- [ ] 语音交互流程
- [ ] 地图交互流程

### 功能测试
- [ ] 测试所有核心功能
- [ ] 测试边界情况
- [ ] 测试错误处理
- [ ] 测试性能（负载测试）

### 兼容性测试
- [ ] Chrome浏览器测试
- [ ] Safari浏览器测试
- [ ] Firefox浏览器测试
- [ ] Edge浏览器测试
- [ ] 移动端浏览器测试

### Bug修复
- [ ] 收集和整理Bug清单
- [ ] 按优先级分类Bug
- [ ] 修复严重Bug
- [ ] 修复一般Bug
- [ ] 回归测试
- [ ] 确认所有Bug已解决

### 性能优化
- [ ] 优化数据库查询
- [ ] 优化API响应时间
- [ ] 优化前端渲染性能
- [ ] 优化内存使用

### 验证
- [ ] 所有单元测试通过
- [ ] 所有集成测试通过
- [ ] E2E测试通过
- [ ] 无严重Bug
- [ ] 性能达标

---

## 📋 阶段10: Docker部署与CI/CD (3-4天)

### Docker化
- [ ] 编写前端Dockerfile
- [ ] 编写后端Dockerfile
- [ ] 编写docker-compose.yml（生产环境）
- [ ] 优化镜像大小（多阶段构建）
- [ ] 配置环境变量
- [ ] 编写Nginx配置

### CI/CD配置
- [ ] 配置GitHub Actions工作流
- [ ] 配置自动测试流程
- [ ] 配置自动构建Docker镜像
- [ ] 配置推送到阿里云镜像仓库
- [ ] 配置自动部署（可选）

### 部署配置
- [ ] 申请阿里云容器镜像服务
- [ ] 配置镜像仓库
- [ ] 配置Nginx反向代理
- [ ] 配置HTTPS证书（可选）
- [ ] 配置域名（可选）

### 监控与日志
- [ ] 配置Winston日志
- [ ] 配置PM2进程管理
- [ ] 配置健康检查
- [ ] 配置错误监控（可选）

### 安全配置
- [ ] 配置安全头（Helmet）
- [ ] 配置CORS
- [ ] 配置API限流
- [ ] 配置SQL注入防护
- [ ] 配置XSS防护

### 文档
- [ ] 编写Docker部署文档
- [ ] 编写环境配置说明
- [ ] 编写API Key获取说明
- [ ] 编写故障排查指南

### 测试
- [ ] 测试Docker镜像构建
- [ ] 测试Docker Compose启动
- [ ] 测试CI/CD流程
- [ ] 测试生产环境部署

### 验证
- [ ] Docker一键部署成功
- [ ] CI/CD流程正常
- [ ] 镜像成功推送
- [ ] 应用可以公网访问（如部署）
- [ ] 所有功能正常工作

---

## 📋 阶段11: 文档与交付 (2-3天)

### 用户文档
- [ ] 编写用户使用指南
- [ ] 录制功能演示视频
- [ ] 编写FAQ文档
- [ ] 准备功能截图

### 开发文档
- [ ] 更新README.md
- [ ] 编写架构设计文档
- [ ] 编写API文档（Swagger/OpenAPI）
- [ ] 编写数据库设计文档
- [ ] 编写模块说明文档

### API文档
- [ ] 使用Swagger生成API文档
- [ ] 编写接口使用示例
- [ ] 编写错误码说明
- [ ] 导出Postman Collection

### 部署文档
- [ ] 编写Docker部署指南
- [ ] 编写环境配置说明
- [ ] 编写API Key配置说明
- [ ] 编写故障排查指南
- [ ] 编写升级指南

### 提交准备
- [ ] 准备API Key（3个月有效期）
- [ ] 整理Git提交历史
- [ ] 确保提交记录清晰
- [ ] 创建项目演示视频
- [ ] 编写项目说明PDF
- [ ] 包含GitHub repo地址
- [ ] 包含Docker镜像下载地址

### 代码审查
- [ ] 移除所有硬编码的API Key
- [ ] 移除测试代码和注释
- [ ] 统一代码风格
- [ ] 添加必要的注释
- [ ] 检查所有TODO

### 最终验证
- [ ] 全功能测试
- [ ] 性能测试
- [ ] 安全检查
- [ ] 文档完整性检查
- [ ] 部署测试

### 交付物清单
- [ ] GitHub仓库（公开/私有）
- [ ] Docker镜像（阿里云）
- [ ] 项目说明PDF
- [ ] API Key文档
- [ ] 演示视频
- [ ] README文档

### 验证
- [ ] 根据文档可以成功部署
- [ ] 所有功能正常工作
- [ ] 文档完整清晰
- [ ] 代码中无敏感信息
- [ ] Git提交历史完整
- [ ] 交付物齐全

---

## 🎉 项目完成

恭喜！当所有检查清单都完成后，你的AI旅行规划师项目就完成了！

### 最后的检查
- [ ] 再次运行所有测试
- [ ] 进行完整的用户流程测试
- [ ] 检查性能指标
- [ ] 检查代码质量
- [ ] 准备项目展示

### 持续改进（可选）
- [ ] 收集用户反馈
- [ ] 修复发现的问题
- [ ] 添加新功能
- [ ] 性能优化
- [ ] 代码重构

---

**祝贺你完成这个项目！🎊**

